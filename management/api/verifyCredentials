var commons = require('management/api/lib/commonsLib');
var loginLib = require("m/login");
var params = {};

if(request.body != null){
	params = request.body;
}else if(request.parameters.body){
	params = request.parameters.body;
} else {
  params = request.parameters;
}
if(typeof params == 'string' && params != null){
  	try{
    	params = JSON.parse(params);   
    }catch(e){
      	return "INVALID OR MISSING PARAMETER";
    }
}


var requiredParams = ["login", "password"];
// START: Integrity checks
var isValidParams = commons.validateParamsNonEmpty(params, requiredParams);
if (isValidParams ["status"] == 'failure') {
    return isValidParams;
}
var login = params.login;
var password = params.password;

return loginLib.verifyCredentials(login, password);



